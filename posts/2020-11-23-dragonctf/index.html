<!DOCTYPE html>


    

<html lang="en-us" data-theme="dark">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>Dragon CTF 2020 Writeup - Black Bauhinia</title>
<meta name="description" content="">

<link rel="icon" type="image/x-icon" href="https://b6a.black/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://b6a.black/favicon.png">



    





    
    
    

    
        <link rel="stylesheet" href="https://b6a.black/css/style.09c94e06b3ec0503263ea0297febd3b62f3d6b2dafd8e813aa92a479e82bc955.css" integrity="sha256-CclOBrPsBQMmPqApf&#43;vTti89ay2v2OgTqpKkeegryVU=">
    





<meta property="og:title" content="Dragon CTF 2020 Writeup" />
<meta property="og:description" content="Dragon CTF 2020 is definitely had my best CTF moments. There are big brain moments and I have been mind-blown for multiple times during the game. This time we have teamed up with @blackb6a. I have solved all the crypto challenges and two challenges with my teammates.
There are three challenges writeup in this post:
 Bit Flip (parts 2 and 3) Frying in motion babykok  Bit Flip (Crypto, 155&#43;324&#43;343 points) Solved by Mystiz." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://b6a.black/posts/2020-11-23-dragonctf/" />
<meta property="article:published_time" content="2020-11-23T04:33:50+08:00" />
<meta property="article:modified_time" content="2020-11-23T04:33:50+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Dragon CTF 2020 Writeup"/>
<meta name="twitter:description" content="Dragon CTF 2020 is definitely had my best CTF moments. There are big brain moments and I have been mind-blown for multiple times during the game. This time we have teamed up with @blackb6a. I have solved all the crypto challenges and two challenges with my teammates.
There are three challenges writeup in this post:
 Bit Flip (parts 2 and 3) Frying in motion babykok  Bit Flip (Crypto, 155&#43;324&#43;343 points) Solved by Mystiz."/>












    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header"> 
            
                <h1 class="site-title">
    <a href="/">Black Bauhinia</a>
</h1>

    <nav>
        
        
        <a class="" href="https://b6a.black/about-us/" title="">About Us</a>
        
    </nav>



            
        </header>
        <main id="main" tabindex="-1"> 
            
    
    
    <article class="post h-entry">
        <header class="post-header">
            <h1 class="p-name post-title">Dragon CTF 2020 Writeup</h1>
        </header>
        <div class="content e-content">
            <p><em>Dragon CTF 2020</em> is definitely had my best CTF moments. There are big brain moments and I have been mind-blown for multiple times during the game. This time we have teamed up with @blackb6a. I have solved all the crypto challenges and two challenges with my teammates.</p>

<p>There are three challenges writeup in this post:</p>

<ul>
<li>Bit Flip (parts 2 and 3)</li>
<li>Frying in motion</li>
<li>babykok</li>
</ul>

<h2 id="bit-flip-crypto-155324343-points">Bit Flip (Crypto, 155+324+343 points)</h2>

<p>Solved by <em>Mystiz</em>.</p>

<h3 id="challenge-summary">Challenge Summary</h3>

<p>At the beginning, a 128-bit <code>alice_secret</code> (denoted as $a$) is generated. We are given an oracle that allows us to input a 256-bit value $v$. An PRNG $R$ uses $a\oplus v$ to derive:</p>

<ol>
<li>a 512-bit prime $p$ that is used for Diffie-Hellman, and</li>
<li>a 64-bit secret $a$ that is Alice's secret key.</li>
</ol>

<p>For each oracle call, the following will be printed</p>

<ol>
<li>The number of <code>rng.getbits(512)</code> calls for $p$ to be a prime,</li>
<li>Bob's public key (which is generated randomly in each call), $B$,</li>
<li>The encrypted flag (with AES-CBC &amp; key is derived from the DH shared key):</li>
</ol>

<p>Of course, <em>the devil is in the detail</em>. The AES-CBC <code>key</code> is derived as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dh_shared_key <span style="color:#f92672">=</span> <span style="color:#ae81ff">1337</span> <span style="color:#f92672">^</span> pow(B, a, p)
key <span style="color:#f92672">=</span> long_to_bytes(dh_shared_key, <span style="color:#ae81ff">16</span>)[:<span style="color:#ae81ff">16</span>]</code></pre></div>
<p>Furthermore, the PRNG is simple. It is maintaining a 256-bit state $s$. 512-bit and 64-bit numbers are generated respectively with:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getbits</span>(bits<span style="color:#f92672">=</span><span style="color:#ae81ff">512</span>):
    output <span style="color:#f92672">=</span> sha256(long_to_bytes(s, <span style="color:#ae81ff">32</span>))<span style="color:#f92672">.</span>digest() <span style="color:#f92672">+</span> sha256(long_to_bytes(s<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">32</span>))<span style="color:#f92672">.</span>digest()
    s <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">return</span> output

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getbits</span>(bits<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>):
    output <span style="color:#f92672">=</span> sha256(long_to_bytes(s, <span style="color:#ae81ff">32</span>))<span style="color:#f92672">.</span>digest()[<span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>:]
    s <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> output</code></pre></div>
<h4 id="the-plot-twist">The plot twist</h4>

<p>This is the setting for part one. Parts two and three are pretty similar though.</p>

<ul>
<li>Parts 2 and 3 are <em>not</em> returning Bob's public key, and</li>
<li>Part 3 uses the prime $p$ and check if $q := 2p+1$ is a prime. The prime $q$ (instead of $p$) is used for DH.</li>
</ul>

<h3 id="solution">Solution</h3>

<h4 id="part-i-the-real-bitflipping">Part I: The real bit-flipping</h4>

<p><em>Bit Flip 1</em> was solved in about 45 minutes. Basically we are able to recover $v$ from the number of <code>rng.getbits(512)</code> calls. Since I am sure that there will be writeups on this part available online, I am skipping this part.</p>

<div class="alert warning">
  I am just going to admit that I am lazy.
</div>
  

<h4 id="part-ii-a-nightmare-on-longtobytes">Part II: A nightmare on <code>long_to_bytes</code></h4>

<p><em>Bit Flip 3</em> was solved in 1 hour - and we were the first to solve. But wait, why isn't part II on <em>Bit Flip 2</em>? The reason is simply because just I cannot solve it (yet).</p>

<figure>
    <img src="/images/2020-11-23-dragonctf/bit-flip-01.png"
         alt="defund had the same question, too."/> <figcaption>
            <p>defund had the same question, too.</p>
        </figcaption>
</figure>


<p>The prime used for Diffie-Hellman can be 513-bit long. This makes the AES key derivation interesting - as <code>long_to_bytes(x, 16)</code> actually prepend null bytes until the output size is a multiple of 16. For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;&gt;</span> long_to_bytes(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">127</span>, <span style="color:#ae81ff">16</span>)<span style="color:#f92672">.</span>hex()
<span style="color:#e6db74">&#39;80000000000000000000000000000000&#39;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> long_to_bytes(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">16</span>)<span style="color:#f92672">.</span>hex()
<span style="color:#e6db74">&#39;0000000000000000000000000000000100000000000000000000000000000000&#39;</span></code></pre></div>
<p>Luckily (or unluckily) the shared key can be as large as 513 bits long. In that case, the first block would be <code>00 00 ... 00 00 01</code> - and this is the AES key.</p>

<p>We do not even need to know Alice's nor Bob's key. Basically there is around 25% chance for the DH shared key to be 513-bit. When it happens, the constant key is used and we are able to decrypt the flag - <code>DrgnS{C0nst_A3S_K3y_1111111111111!}</code>. First blood ðŸ©¸!</p>

<h4 id="part-iii-playing-mindgames-on-bit-flip-2">Part III: Playing mind-games on <em>Bit Flip 2</em></h4>

<p><em>Bit Flip 2</em> was solved in about 12 hours. I was mind-blown when I know <em>da wae</em>. Since the DH key could never be 513 bits long anymore, we can no longer exploit in the way as described in <em>Bit Flip 3</em>.</p>

<div class="alert warning">
  <strong>Wait.</strong> This made me <em>very</em> puzzled: How do we find the shared key (or $g^{ab}\ (\text{mod}\ p)$) if Bob is not telling us anything?
</div>
  

<p>Basically we have three options:</p>

<ol>
<li>Make $a = 0$. This implies that $g^{ab} \equiv 1$, resulting in a constant key.</li>
<li>Find $a$ and $p$ such that $g^a\in\mathbb{Z}_p^*$ has a small order. Hence $\{g^{ab}\in\mathbb{Z}_p^*\ |\ b\in\mathbb{Z}\}$ can be exhausted feasibly.</li>
<li>Make $p$ 385-bit long (or 1-bit, 129-bit or 257-bit). Then we are able to reuse the exploit on <em>Bit Flip 3</em>.</li>
</ol>

<p>There is a point of time that over 10 teams have solved <em>Bit Flip 2</em> while only <em>hxp</em> and us have solved <em>Bit Flip 3</em>. If option 3 is the way to go, the number of solves would not be the same. Moreover, option 2 is barely possible in a perspective of math. That said, unless there is a vulnerability that I am not awared of, we may need to make $a = 0$. That is equivalent to <code>rng.getbits(64) == 0</code> and thus a 64-bit proof-of-work. Possible?</p>

<p>During the research, I was wondering if there is a proof-of-work database that has a list of payloads with many trailing zeros as its hash. I was even wondering if there is someone ever able to solve a 64-bit proof-of-work (particularly on SHA256). Turns out I am too naive - <em>some</em> are able to solve a 76-bit proof-of-work in around 10 minutes. Who? The bitcoin network.</p>

<figure>
    <img src="/images/2020-11-23-dragonctf/bit-flip-02.png"
         alt="Let&amp;rsquo;s appreciate the number of zeros&amp;hellip;"/> <figcaption>
            <p>Let&rsquo;s appreciate the number of zeros&hellip;</p>
        </figcaption>
</figure>


<p>The <a href="https://en.bitcoin.it/wiki/Block_hashing_algorithm">block hashing algorithm</a> for Bitcoin is SHA256. This is how block 125552 (the smallest hash as of June 2011) is computed:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">d <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#39;0100000081cd02ab7e569e8bcd9317e2fe99f2de44d49ab2b8851ba4a30&#39;</span> <span style="color:#f92672">+</span>
                  <span style="color:#e6db74">&#39;8000000000000e320b6c2fffc8d750423db8b1eb942ae710e951ed797f7&#39;</span> <span style="color:#f92672">+</span>
                  <span style="color:#e6db74">&#39;affc8892b0f1fc122bc7f5d74df2b9441a42a14695&#39;</span>)
m <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha256(d)<span style="color:#f92672">.</span>digest()
<span style="color:#66d9ef">print</span>(m<span style="color:#f92672">.</span>hex())
<span style="color:#75715e"># b9d751533593ac10cdfb7b8e03cad8babc67d8eaeac0a3699b82857dacac9390</span>
h <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha256(m)<span style="color:#f92672">.</span>digest()
<span style="color:#66d9ef">print</span>(h<span style="color:#f92672">.</span>hex())
<span style="color:#75715e"># 1dbd981fe6985776b644b173a4d0385ddc1aa2a829688d1e0000000000000000</span></code></pre></div>
<p>The above hash ends with 8 null bytes. If the below seed generates a prime in its first call of <code>rng.getbits(512)</code>, then <code>a = 0</code>:</p>

<p><code>seed = 0xb9d751533593ac10cdfb7b8e03cad8babc67d8eaeac0a3699b82857dacac938c</code>.</p>

<p>Unfortunately it is not. Luckily there are many inputs (available on the Bitcoin network) that generates eight trailing null bytes as its hash. We can simply look at the blocks and find the one we need. For me, I was using the block API from <em>blockcypher.com</em> to retrieve and compute the preimage of hashes. Eventually <a href="https://live.blockcypher.com/btc/block/657972">block 657972</a> satisfies our needs and the Alice's secret key will be $a = 0$.</p>

<p>That said, the AES key would be <code>00 00 ... 00 05 38</code> when $a = 0$ - and we are able to decrypt the flag: <code>DrgnS{B1tc0in_p0w3r_crypt0_brut3}</code>! :tada:</p>

<h2 id="frying-in-motion-crypto-324-points">Frying in motion (Crypto, 324 points)</h2>

<p>Solved by <em>Mystiz</em>.</p>

<h3 id="challenge-summary-1">Challenge Summary</h3>

<p>The challenge is simple. Upon connecting to the challenge server,</p>

<ul>
<li>257 HEX characters are generated, <code>strfry</code>-ed for <code>0x140000</code> times. Nothing is returned. (<em>This took around 5 seconds</em>)</li>
<li>Players are allowed to send up to 4096 bytes. The server returns the <code>strfry</code>-ed input.</li>
<li>64 HEX characters (denote as <code>fry_buf</code>) <code>strfry</code>-ed and returned.</li>
<li>The player is expected to find <code>fry_buf</code>.</li>
</ul>

<p>More importantly, the challenge server has a timeout of 20 seconds. Hence, you have to compute from the <code>strfry</code>-ed response in 15 seconds.</p>

<h3 id="solution-1">Solution</h3>

<h4 id="part-i-the-first-encounter">Part I: The first encounter</h4>

<blockquote>
<p>&quot;WTF. Yet another <code>strfry</code> question? It must be very boring.&quot; ~ <em>Mystiz</em></p>
</blockquote>

<p>This is the first comment I made to the challenge. It is actually much interesting than I thought and I have spent a good 5 hours for the challenge.</p>

<p>The previous CTFs (for example, challenge from <a href="https://ctftime.org/task/10764">Ã¥ngstromCTF 2020</a> and <a href="https://ctftime.org/task/11259">DawgCTF 2020</a>) exploited on the small seed space that can be exhausted. In the previous versions of libc, the seeds for <code>strfry</code> is given by <code>time(NULL) ^ getpid()</code>. I was trying to print <code>time(NULL)</code> and <code>getpid()</code> alongside with the  <code>strfry</code> result, but the seed does not check out. What? Maybe the world is not peaceful anymore in <em>libc 2.31-0ubuntu9</em>. Let's download the source code and have a read.</p>

<h4 id="part-ii-codereading-game">Part II: Code-reading game</h4>

<p>Let's verify the first point - is the implementation for <code>strfry</code> changed?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">// string/strfry.c
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>
<span style="color:#a6e22e">strfry</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>string)
{
  <span style="color:#75715e">// omitted...
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>init)
    {
      <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> state[<span style="color:#ae81ff">32</span>];
      rdata.state <span style="color:#f92672">=</span> NULL;
      __initstate_r (random_bits (),
		     state, <span style="color:#66d9ef">sizeof</span> (state), <span style="color:#f92672">&amp;</span>rdata);
      init <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    }
  <span style="color:#75715e">// omitted...
</span><span style="color:#75715e"></span>}</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">// include/random-bits.h
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">inline</span> uint32_t
<span style="color:#a6e22e">random_bits</span> (<span style="color:#66d9ef">void</span>)
{
  <span style="color:#66d9ef">struct</span> timespec tv;
  __clock_gettime (CLOCK_MONOTONIC, <span style="color:#f92672">&amp;</span>tv);
  <span style="color:#75715e">/* Shuffle the lower bits to minimize the clock bias.  */</span>
  uint32_t ret <span style="color:#f92672">=</span> tv.tv_nsec <span style="color:#f92672">^</span> tv.tv_sec;
  ret <span style="color:#f92672">^=</span> (ret <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">24</span>) <span style="color:#f92672">|</span> (ret <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span>);
  <span style="color:#66d9ef">return</span> ret;
}</code></pre></div>
<p>Although the string is fried in the same way, the seed is changed! Since the seed is 32 bits long, maybe I can just exhaust it. However it takes 5 seconds to <code>strfry</code> a 257-byte long string for 0x140000 times, it is not feasible to brute force with the challenge implementation. Let's read how random numbers are generated.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">// stdlib/random_r.c
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span>
<span style="color:#a6e22e">__initstate_r</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> seed, <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>arg_state, size_t n,
	       <span style="color:#66d9ef">struct</span> random_data <span style="color:#f92672">*</span>buf)
{
  <span style="color:#75715e">// omitted...
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> type;
  <span style="color:#66d9ef">if</span> (n <span style="color:#f92672">&gt;=</span> BREAK_3)
    type <span style="color:#f92672">=</span> n <span style="color:#f92672">&lt;</span> BREAK_4 <span style="color:#f92672">?</span> TYPE_3 : TYPE_4;
  <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (n <span style="color:#f92672">&lt;</span> BREAK_1)
    {
      <span style="color:#66d9ef">if</span> (n <span style="color:#f92672">&lt;</span> BREAK_0)
	<span style="color:#66d9ef">goto</span> fail;

      type <span style="color:#f92672">=</span> TYPE_0;
    }
  <span style="color:#66d9ef">else</span>
    type <span style="color:#f92672">=</span> n <span style="color:#f92672">&lt;</span> BREAK_2 <span style="color:#f92672">?</span> TYPE_1 : TYPE_2;

  <span style="color:#66d9ef">int</span> degree <span style="color:#f92672">=</span> random_poly_info.degrees[type];
  <span style="color:#66d9ef">int</span> separation <span style="color:#f92672">=</span> random_poly_info.seps[type];

  buf<span style="color:#f92672">-&gt;</span>rand_type <span style="color:#f92672">=</span> type;
  buf<span style="color:#f92672">-&gt;</span>rand_sep <span style="color:#f92672">=</span> separation;
  buf<span style="color:#f92672">-&gt;</span>rand_deg <span style="color:#f92672">=</span> degree;
  int32_t <span style="color:#f92672">*</span>state <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>((int32_t <span style="color:#f92672">*</span>) arg_state)[<span style="color:#ae81ff">1</span>];	<span style="color:#75715e">/* First location.  */</span>
  <span style="color:#75715e">/* Must set END_PTR before srandom.  */</span>
  buf<span style="color:#f92672">-&gt;</span>end_ptr <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>state[degree];

  buf<span style="color:#f92672">-&gt;</span>state <span style="color:#f92672">=</span> state;

  __srandom_r (seed, buf);

  state[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> TYPE_0;
  <span style="color:#66d9ef">if</span> (type <span style="color:#f92672">!=</span> TYPE_0)
    state[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> (buf<span style="color:#f92672">-&gt;</span>rptr <span style="color:#f92672">-</span> state) <span style="color:#f92672">*</span> MAX_TYPES <span style="color:#f92672">+</span> type;
  <span style="color:#75715e">// omitted...
</span><span style="color:#75715e"></span>}</code></pre></div>
<p><code>strfry</code> uses a 32-byte state, which indicates that <code>TYPE_1</code> PRNG is used. Seven 32-bit unsigned integer is derived from the seed (denote it as <code>s[0]</code>, <code>s[1]</code>, ..., <code>s[6]</code>) and set the counter <code>c := 0</code>. This is the equivalent Python code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GlibcRandom</span>:
    <span style="color:#66d9ef">def</span> __init__(self, seed):
        self<span style="color:#f92672">.</span>init_state(seed)
        [self<span style="color:#f92672">.</span>next() <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">70</span>)]

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">init_state</span>(self, seed):
        state <span style="color:#f92672">=</span> [seed]
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>):
            h, l <span style="color:#f92672">=</span> seed <span style="color:#f92672">//</span> <span style="color:#ae81ff">127773</span>, seed <span style="color:#f92672">%</span> <span style="color:#ae81ff">127773</span>

            seed <span style="color:#f92672">=</span> (<span style="color:#ae81ff">16807</span> <span style="color:#f92672">*</span> l <span style="color:#f92672">-</span> <span style="color:#ae81ff">2836</span> <span style="color:#f92672">*</span> h) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x7fffffff</span>
            state<span style="color:#f92672">.</span>append(seed)
        self<span style="color:#f92672">.</span>state <span style="color:#f92672">=</span> [
            state,
            <span style="color:#ae81ff">0</span>
        ]
    
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">next</span>(self):
        s, t <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>state
        v <span style="color:#f92672">=</span> (s[(t<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> s[t <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>]) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffffffff</span>
        v <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>

        s[(t<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>] <span style="color:#f92672">+=</span> s[t <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>]
        s[(t<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>] <span style="color:#f92672">&amp;=</span> <span style="color:#ae81ff">0xffffffff</span>

        self<span style="color:#f92672">.</span>state <span style="color:#f92672">=</span> [s, (t <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span>]
        <span style="color:#66d9ef">return</span> v</code></pre></div>
<h4 id="part-iii-fastforwarding-the-states">Part III: Fast-forwarding the states</h4>

<p>Fast-forwarding the PRNG is easy. This is similar on the <a href="/posts/2020-09-08-confidencectf-team-trees/#42-fast-sequence-generation">Team Trees</a> challenge in CONFidence CTF this year. We can skip states with the matrix implementation (and I am able to skip the details for this part, too). After all, 5M seeds can be checked per second. Since we have only 15 seconds to recover the seed, we are unable to find the entire search space (only 1.75% of the seed space is checked). In average, we can recover the seed from the <code>strfry</code> output in 15 seconds once every 60 times. Finally, if we are able to recover the seed, we can freely fry and unfry strings.</p>

<p>After two hours, we have the flag: <code>DrgnS{Fr13d_57r1Ng5_4r3_tH3_Be5t_s7r1NgS!}</code>.</p>

<h2 id="babykok-misc-215-points">babykok (Misc, 215 points)</h2>

<p>Solved by <em>GeoffreyY</em>.</p>

<p>We simply have to solve some theorems using <a href="https://coq.inria.fr/">Coq</a>.</p>

<p>Good thing I have written some <a href="https://leanprover.github.io/">lean</a> before, so learning / writing Coq isn't that difficult.</p>

<p>For the first part we have to solve the following 6 theorems in some random order.</p>

<p>I'd like to thank my teammate @ozetta for finding this powerful coq tactic <code>intuition</code>, and @harrier_lcc for showing us his coq and how to use it.</p>

<div class="alert info">
  This would&rsquo;ve taken a lot longer if we didn&rsquo;t watch him livestreaming playing around with his coq.
His coq is very very nah that&rsquo;s it I&rsquo;m done with the jokes.
</div>
  
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">Theorem</span> problem0<span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> A B <span style="color:#f92672">:</span> <span style="color:#66d9ef">Prop</span><span style="color:#f92672">,</span> A <span style="color:#f92672">\/</span> B <span style="color:#f92672">-&gt;</span> B <span style="color:#f92672">\/</span> A<span style="color:#f92672">.</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intuition</span><span style="color:#f92672">.</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">Theorem</span> problem1<span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> A B C D <span style="color:#f92672">:</span> <span style="color:#66d9ef">Prop</span><span style="color:#f92672">,</span> <span style="color:#f92672">(</span>A <span style="color:#f92672">-&gt;</span> B<span style="color:#f92672">)</span> <span style="color:#f92672">/\</span> <span style="color:#f92672">(</span>C <span style="color:#f92672">-&gt;</span> D<span style="color:#f92672">)</span> <span style="color:#f92672">/\</span> A <span style="color:#f92672">/\</span> C <span style="color:#f92672">-&gt;</span> B <span style="color:#f92672">/\</span> D<span style="color:#f92672">.</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intuition</span><span style="color:#f92672">.</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">Theorem</span> problem2<span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> A B <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span><span style="color:#f92672">,</span> <span style="color:#f92672">((((</span>A <span style="color:#f92672">-&gt;</span> B<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> A<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> A<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> B<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> B<span style="color:#f92672">.</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intuition</span><span style="color:#f92672">.</span></code></pre></div>
<p>We actually have to do some work with the remaining 3 starter problems:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">Theorem</span> problem3<span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> b1 b2 <span style="color:#f92672">:</span> <span style="color:#66d9ef">bool</span><span style="color:#f92672">,</span> negb <span style="color:#f92672">(</span>b1 <span style="color:#f92672">&amp;&amp;</span> b2<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>negb b1 <span style="color:#f92672">||</span> negb b2<span style="color:#f92672">)%</span><span style="color:#66d9ef">bool</span><span style="color:#f92672">.</span>

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intros</span><span style="color:#f92672">.</span>

<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 10<span style="color:#f92672">)</span>

  b1<span style="color:#f92672">,</span> b2 <span style="color:#f92672">:</span> <span style="color:#66d9ef">bool</span>
  <span style="color:#f92672">============================</span>
  negb <span style="color:#f92672">(</span>b1 <span style="color:#f92672">&amp;&amp;</span> b2<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>negb b1 <span style="color:#f92672">||</span> negb b2<span style="color:#f92672">)%</span><span style="color:#66d9ef">bool</span></code></pre></div>
<p>The general idea for all of these proofs is to apply <code>induction</code> to split the proof into smaller, simple cases.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">induction</span> b1<span style="color:#f92672">.</span>

<span style="color:#f92672">&lt;&lt;&lt;</span> 2 subgoals <span style="color:#f92672">(</span>ID 14<span style="color:#f92672">)</span>

  b2 <span style="color:#f92672">:</span> <span style="color:#66d9ef">bool</span>
  <span style="color:#f92672">============================</span>
  negb <span style="color:#f92672">(</span>true <span style="color:#f92672">&amp;&amp;</span> b2<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>negb true <span style="color:#f92672">||</span> negb b2<span style="color:#f92672">)%</span><span style="color:#66d9ef">bool</span>

subgoal 2 <span style="color:#f92672">(</span>ID 15<span style="color:#f92672">)</span> <span style="color:#66d9ef">is</span><span style="color:#f92672">:</span>
 negb <span style="color:#f92672">(</span>false <span style="color:#f92672">&amp;&amp;</span> b2<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>negb false <span style="color:#f92672">||</span> negb b2<span style="color:#f92672">)%</span><span style="color:#66d9ef">bool</span>

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">auto</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">auto</span><span style="color:#f92672">.</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">Theorem</span> problem4<span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> <span style="color:#f92672">(</span>C <span style="color:#f92672">:</span> <span style="color:#66d9ef">Prop</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>T <span style="color:#f92672">:</span> <span style="color:#f92672">Set</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>B <span style="color:#f92672">:</span> T <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Prop</span><span style="color:#f92672">),</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">exists</span> x <span style="color:#f92672">:</span> T<span style="color:#f92672">,</span> C <span style="color:#f92672">-&gt;</span> B x<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> C <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> x <span style="color:#f92672">:</span> T<span style="color:#f92672">,</span> B x<span style="color:#f92672">.</span>

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intros</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 23<span style="color:#f92672">)</span>

  C <span style="color:#f92672">:</span> <span style="color:#66d9ef">Prop</span>
  T <span style="color:#f92672">:</span> <span style="color:#f92672">Set</span>
  B <span style="color:#f92672">:</span> T <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Prop</span>
  H <span style="color:#f92672">:</span> <span style="color:#66d9ef">exists</span> x <span style="color:#f92672">:</span> T<span style="color:#f92672">,</span> C <span style="color:#f92672">-&gt;</span> B x
  H0 <span style="color:#f92672">:</span> C
  <span style="color:#f92672">============================</span>
  <span style="color:#66d9ef">exists</span> x <span style="color:#f92672">:</span> T<span style="color:#f92672">,</span> B x

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">induction</span> H<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 30<span style="color:#f92672">)</span>

  C <span style="color:#f92672">:</span> <span style="color:#66d9ef">Prop</span>
  T <span style="color:#f92672">:</span> <span style="color:#f92672">Set</span>
  B <span style="color:#f92672">:</span> T <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Prop</span>
  x <span style="color:#f92672">:</span> T
  H <span style="color:#f92672">:</span> C <span style="color:#f92672">-&gt;</span> B x
  H0 <span style="color:#f92672">:</span> C
  <span style="color:#f92672">============================</span>
  <span style="color:#66d9ef">exists</span> x0 <span style="color:#f92672">:</span> T<span style="color:#f92672">,</span> B x0

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">apply</span> H <span style="color:#66d9ef">in</span> H0<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 31<span style="color:#f92672">)</span>

  C <span style="color:#f92672">:</span> <span style="color:#66d9ef">Prop</span>
  T <span style="color:#f92672">:</span> <span style="color:#f92672">Set</span>
  B <span style="color:#f92672">:</span> T <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Prop</span>
  x <span style="color:#f92672">:</span> T
  H <span style="color:#f92672">:</span> C <span style="color:#f92672">-&gt;</span> B x
  H0 <span style="color:#f92672">:</span> B x
  <span style="color:#f92672">============================</span>
  <span style="color:#66d9ef">exists</span> x0 <span style="color:#f92672">:</span> T<span style="color:#f92672">,</span> B x0

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">exists</span> x<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 34<span style="color:#f92672">)</span>

  C <span style="color:#f92672">:</span> <span style="color:#66d9ef">Prop</span>
  T <span style="color:#f92672">:</span> <span style="color:#f92672">Set</span>
  B <span style="color:#f92672">:</span> T <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Prop</span>
  x <span style="color:#f92672">:</span> T
  H <span style="color:#f92672">:</span> C <span style="color:#f92672">-&gt;</span> B x
  H0 <span style="color:#f92672">:</span> B x
  <span style="color:#f92672">============================</span>
  B x

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">assumption</span><span style="color:#f92672">.</span></code></pre></div>
<p>Instead of explicitly using <code>apply H in H0.</code>, I've now discovered that the following simpler proof also works:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#66d9ef">intros</span><span style="color:#f92672">.</span>
<span style="color:#66d9ef">induction</span> H<span style="color:#f92672">.</span>
<span style="color:#66d9ef">exists</span> x<span style="color:#f92672">.</span>
<span style="color:#66d9ef">auto</span><span style="color:#f92672">.</span></code></pre></div>
<p>We have to deal with natural numbers for the final starter problem, which we can also solve using induction:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">Theorem</span> problem5<span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> m n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span> m <span style="color:#f92672">+</span> n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> m<span style="color:#f92672">.</span>

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intros</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">induction</span> m<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 2 subgoals <span style="color:#f92672">(</span>ID 14<span style="color:#f92672">)</span>

  n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  <span style="color:#f92672">============================</span>
  0 <span style="color:#f92672">+</span> n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> 0

subgoal 2 <span style="color:#f92672">(</span>ID 18<span style="color:#f92672">)</span> <span style="color:#66d9ef">is</span><span style="color:#f92672">:</span>
 S m <span style="color:#f92672">+</span> n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> S m

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">auto</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 18<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  IHm <span style="color:#f92672">:</span> m <span style="color:#f92672">+</span> n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> m
  <span style="color:#f92672">============================</span>
  S m <span style="color:#f92672">+</span> n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> S m

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">simpl</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 21<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  IHm <span style="color:#f92672">:</span> m <span style="color:#f92672">+</span> n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> m
  <span style="color:#f92672">============================</span>
  S <span style="color:#f92672">(</span>m <span style="color:#f92672">+</span> n<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> S m

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">rewrite</span> IHm<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 22<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  IHm <span style="color:#f92672">:</span> m <span style="color:#f92672">+</span> n <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> m
  <span style="color:#f92672">============================</span>
  S <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> n <span style="color:#f92672">+</span> S m

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">auto</span><span style="color:#f92672">.</span></code></pre></div>
<p>There are only 2 more problems after the starter 6.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq">nice warmup<span style="color:#f92672">,</span> lets <span style="color:#66d9ef">do</span> some math<span style="color:#f92672">!</span>
<span style="color:#f92672">Require</span> <span style="color:#f92672">Import</span> Arith<span style="color:#f92672">.</span>Mult<span style="color:#f92672">.</span>
<span style="color:#f92672">Theorem</span> math_problem<span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> m n<span style="color:#f92672">,</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">=</span>  n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> 2 <span style="color:#f92672">*</span> n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m<span style="color:#f92672">.</span></code></pre></div>
<p>The idea with this one is simply to expand both sides, and let the theorem prover see that both sides have the same terms.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intros</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">simpl</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 13<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  <span style="color:#f92672">============================</span>
  <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> 0<span style="color:#f92672">))</span> <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">rewrite</span> mult_plus_distr_r<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">rewrite</span> mult_plus_distr_r<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 15<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  <span style="color:#f92672">============================</span>
  n <span style="color:#f92672">*</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">rewrite</span> mult_plus_distr_l<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">rewrite</span> mult_plus_distr_l<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 17<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  <span style="color:#f92672">============================</span>
  n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>m <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> m<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">rewrite</span> plus_assoc<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">rewrite</span> plus_assoc<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 19<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  <span style="color:#f92672">============================</span>
  n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m

<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#66d9ef">rewrite</span> plus_0_r<span style="color:#f92672">.</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 20<span style="color:#f92672">)</span>

  m<span style="color:#f92672">,</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  <span style="color:#f92672">============================</span>
  n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> n <span style="color:#f92672">*</span> m <span style="color:#f92672">+</span> m <span style="color:#f92672">*</span> m
<span style="color:#f92672">&lt;&lt;&lt;</span> firstorder<span style="color:#f92672">.</span></code></pre></div>
<p><code>firstorder</code> didn't work on my machine but worked on the server Â¯\_(ãƒ„)_/Â¯</p>

<p>The final question took us a while:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq">gj<span style="color:#f92672">,</span> now something more interesting<span style="color:#f92672">,</span> can you prove my code works<span style="color:#f92672">?</span>

<span style="color:#f92672">Require</span> <span style="color:#f92672">Import</span> Le<span style="color:#f92672">.</span>
<span style="color:#f92672">Section</span> last_stage<span style="color:#f92672">.</span>
  <span style="color:#f92672">Variable</span> A <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span><span style="color:#f92672">.</span>

  <span style="color:#f92672">Inductive</span> <span style="color:#66d9ef">list</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span>  <span style="color:#f92672">:=</span>
   <span style="color:#f92672">|</span> nil <span style="color:#f92672">:</span> <span style="color:#66d9ef">list</span>
   <span style="color:#f92672">|</span> cons <span style="color:#f92672">:</span> A <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">list</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">list</span><span style="color:#f92672">.</span>


  <span style="color:#f92672">Fixpoint</span> nth <span style="color:#f92672">(</span>l <span style="color:#f92672">:</span> <span style="color:#66d9ef">list</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">)</span> <span style="color:#f92672">:</span> option A <span style="color:#f92672">:=</span>
    <span style="color:#66d9ef">match</span> n<span style="color:#f92672">,</span>l <span style="color:#66d9ef">with</span>
      <span style="color:#f92672">|</span> 0<span style="color:#f92672">,</span> cons x xs  <span style="color:#f92672">=&gt;</span> Some x
      <span style="color:#f92672">|</span> S n<span style="color:#f92672">,</span> cons <span style="color:#f92672">_</span> xs  <span style="color:#f92672">=&gt;</span> nth xs n
      <span style="color:#f92672">|</span> <span style="color:#f92672">_,</span> <span style="color:#f92672">_</span> <span style="color:#f92672">=&gt;</span> None
    <span style="color:#66d9ef">end</span><span style="color:#f92672">.</span>

  <span style="color:#f92672">Fixpoint</span> length <span style="color:#f92672">(</span>l<span style="color:#f92672">:</span><span style="color:#66d9ef">list</span><span style="color:#f92672">)</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span> <span style="color:#f92672">:=</span>
    <span style="color:#66d9ef">match</span> l <span style="color:#66d9ef">with</span>
      <span style="color:#f92672">|</span> nil <span style="color:#f92672">=&gt;</span> 0
      <span style="color:#f92672">|</span> cons <span style="color:#f92672">_</span> xs <span style="color:#f92672">=&gt;</span> 1 <span style="color:#f92672">+</span> length xs
    <span style="color:#66d9ef">end</span><span style="color:#f92672">.</span>

<span style="color:#f92672">Theorem</span> nth_in<span style="color:#f92672">:</span>  <span style="color:#66d9ef">forall</span> <span style="color:#f92672">(</span>n<span style="color:#f92672">:</span><span style="color:#66d9ef">nat</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>l<span style="color:#f92672">:</span><span style="color:#66d9ef">list</span><span style="color:#f92672">),</span> n <span style="color:#f92672">&lt;</span> length l <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a<span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth l n <span style="color:#f92672">=</span> Some a<span style="color:#f92672">.</span></code></pre></div>
<p>The idea for this is induction on both <code>n</code> and <code>l</code>. It should be easy for the base cases of <code>n</code> is <code>0</code>, or <code>l</code> is <code>nil</code>, and induction completes the rest of the proof.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-coq" data-lang="coq"><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intros</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">revert</span> H<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">revert</span> n<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 15<span style="color:#f92672">)</span>

  A <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span>
  l <span style="color:#f92672">:</span> <span style="color:#66d9ef">list</span>
  <span style="color:#f92672">============================</span>
  <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span> n <span style="color:#f92672">&lt;</span> length l <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth l n <span style="color:#f92672">=</span> Some a

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">induction</span> l<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 2 subgoals <span style="color:#f92672">(</span>ID 19<span style="color:#f92672">)</span>

  A <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span>
  <span style="color:#f92672">============================</span>
  <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span> n <span style="color:#f92672">&lt;</span> length nil <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth nil n <span style="color:#f92672">=</span> Some a

subgoal 2 <span style="color:#f92672">(</span>ID 23<span style="color:#f92672">)</span> <span style="color:#66d9ef">is</span><span style="color:#f92672">:</span>
 <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span>
 n <span style="color:#f92672">&lt;</span> length <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> n <span style="color:#f92672">=</span> Some a0

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">inversion</span> 1<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 23<span style="color:#f92672">)</span>

  A <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span>
  a <span style="color:#f92672">:</span> A
  l <span style="color:#f92672">:</span> <span style="color:#66d9ef">list</span>
  IHl <span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span> n <span style="color:#f92672">&lt;</span> length l <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth l n <span style="color:#f92672">=</span> Some a
  <span style="color:#f92672">============================</span>
  <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span>
  n <span style="color:#f92672">&lt;</span> length <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> n <span style="color:#f92672">=</span> Some a0

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">induction</span> n<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 2 subgoals <span style="color:#f92672">(</span>ID 50<span style="color:#f92672">)</span>

  A <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span>
  a <span style="color:#f92672">:</span> A
  l <span style="color:#f92672">:</span> <span style="color:#66d9ef">list</span>
  IHl <span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span> n <span style="color:#f92672">&lt;</span> length l <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth l n <span style="color:#f92672">=</span> Some a
  <span style="color:#f92672">============================</span>
  0 <span style="color:#f92672">&lt;</span> length <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> 0 <span style="color:#f92672">=</span> Some a0

subgoal 2 <span style="color:#f92672">(</span>ID 53<span style="color:#f92672">)</span> <span style="color:#66d9ef">is</span><span style="color:#f92672">:</span>
 S n <span style="color:#f92672">&lt;</span> length <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>S n<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> Some a0

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">simpl</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 2 subgoals <span style="color:#f92672">(</span>ID 84<span style="color:#f92672">)</span>
  <span style="color:#f92672">...</span>
  0 <span style="color:#f92672">&lt;</span> S <span style="color:#f92672">(</span>length l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> Some a <span style="color:#f92672">=</span> Some a0
  <span style="color:#f92672">...</span>

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">intro</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 2 subgoals <span style="color:#f92672">(</span>ID 60<span style="color:#f92672">)</span>
  <span style="color:#f92672">...</span>
  <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> Some a <span style="color:#f92672">=</span> Some a0
  <span style="color:#f92672">...</span>

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">exists</span> a<span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#f92672">...</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">auto</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 53<span style="color:#f92672">)</span>

  A <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span>
  a <span style="color:#f92672">:</span> A
  l <span style="color:#f92672">:</span> <span style="color:#66d9ef">list</span>
  IHl <span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span> n <span style="color:#f92672">&lt;</span> length l <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth l n <span style="color:#f92672">=</span> Some a
  n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  IHn <span style="color:#f92672">:</span> n <span style="color:#f92672">&lt;</span> length <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> n <span style="color:#f92672">=</span> Some a0
  <span style="color:#f92672">============================</span>
  S n <span style="color:#f92672">&lt;</span> length <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>S n<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> Some a0

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">simpl</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&lt;&lt;&lt;</span> 1 subgoal <span style="color:#f92672">(</span>ID 68<span style="color:#f92672">)</span>

  A <span style="color:#f92672">:</span> <span style="color:#66d9ef">Type</span>
  a <span style="color:#f92672">:</span> A
  l <span style="color:#f92672">:</span> <span style="color:#66d9ef">list</span>
  IHl <span style="color:#f92672">:</span> <span style="color:#66d9ef">forall</span> n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span><span style="color:#f92672">,</span> n <span style="color:#f92672">&lt;</span> length l <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth l n <span style="color:#f92672">=</span> Some a
  n <span style="color:#f92672">:</span> <span style="color:#66d9ef">nat</span>
  IHn <span style="color:#f92672">:</span> n <span style="color:#f92672">&lt;</span> length <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth <span style="color:#f92672">(</span>cons a l<span style="color:#f92672">)</span> n <span style="color:#f92672">=</span> Some a0
  <span style="color:#f92672">============================</span>
  S n <span style="color:#f92672">&lt;</span> S <span style="color:#f92672">(</span>length l<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">exists</span> a0 <span style="color:#f92672">:</span> A<span style="color:#f92672">,</span> nth l n <span style="color:#f92672">=</span> Some a0

<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">auto</span> <span style="color:#66d9ef">with</span> arith<span style="color:#f92672">.</span></code></pre></div>
<p>Finally we have the flag:</p>

<p><code>gj flag: DrgnS{xxxx_my_c0q_for_4_flag_17bcbc34b7c565a766e335}</code></p>

        </div>
        


<div class="post-info">
    
        <div class="post-date dt-published">2020-11-23</div>
    
    
    <a class="post-hidden-url u-url" href="https://b6a.black/posts/2020-11-23-dragonctf/">https://b6a.black/posts/2020-11-23-dragonctf/</a>
    <a href=https://b6a.black/ class="p-name p-author post-hidden-author h-card" rel="me">[Mystiz GeoffreyY]</a>


    <div class="post-taxonomies">
        
            
                <ul class="post-tags">
                    
                        <li><a href="https://b6a.black/tags/ctf">#ctf</a></li>
                    
                        <li><a href="https://b6a.black/tags/dragonctf">#dragonctf</a></li>
                    
                        <li><a href="https://b6a.black/tags/crypto">#crypto</a></li>
                    
                </ul>
        
    </div>
</div>

    </article>

    

    

    


        </main>
        
            <footer class="common-footer">
    
    

    <div class="common-footer-bottom">
        
        <div class="copyright">
            <p>Â© 2021<br>
            Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.<br>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
  integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
  integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
  integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
  onload="renderMathInElement(document.body, { delimiters: [{ left: '$$', right: '$$', display: true }, { left: '\\[', right: '\\]', display: true }, { left: '$', right: '$', display: false }, { left: '\\(', right: '\\)', display: false }]})"></script>

            </p>  
        </div> 

        

    


   
    </div>

    <p class="h-card vcard">

    <a href=https://b6a.black/ class="p-name u-url url fn" rel="me"></a> 

    

    
</p> 
</footer>

        
    </div>
</body>
</html>
